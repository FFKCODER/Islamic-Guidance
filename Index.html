<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mood Care | Islamic Guidance</title>
  <style>
    :root {
      --bg: #0f172a;         /* base slate-900 */
      --card: #111827;       /* gray-900 */
      --text: #e5e7eb;       /* gray-200 */
      --muted: #94a3b8;      /* slate-400 */
      --accent: #22d3ee;     /* cyan-400 */
      --ring: rgba(255,255,255,.18);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    /* Mood themes */
    .mood-happy { --bg:#052e16; --card:#064e3b; --text:#ecfccb; --muted:#bbf7d0; --accent:#a7f3d0; }
    .mood-sad { --bg:#0b1026; --card:#11183a; --text:#e0e7ff; --muted:#a5b4fc; --accent:#60a5fa; }
    .mood-anger { --bg:#1b0a0a; --card:#3b0d0d; --text:#fee2e2; --muted:#fecaca; --accent:#fca5a5; }
    .mood-depressed { --bg:#0b0f16; --card:#10151f; --text:#e2e8f0; --muted:#94a3b8; --accent:#38bdf8; }
    .mood-jealous { --bg:#0a1a12; --card:#0f2a1c; --text:#dcfce7; --muted:#bbf7d0; --accent:#34d399; }

    * { box-sizing: border-box; }
    body {
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 70% -10%, rgba(255,255,255,.06), transparent), var(--bg);
      color: var(--text);
      transition: background-color .4s ease, color .3s ease;
      min-height:100dvh;
      display:flex; align-items:center; justify-content:center;
      padding:24px;
    }
    .container {
      width:100%; max-width: 980px;
    }
    .card {
      background: linear-gradient(180deg, color-mix(in oklab, var(--card), black 6%), var(--card));
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 18px;
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    header {
      padding: 22px 24px;
      display:flex; align-items:center; justify-content:space-between;
      border-bottom: 1px solid rgba(255,255,255,.06);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .brand { font-weight: 700; letter-spacing:.3px; }
    .step {
      display:none; padding: 28px; gap:24px;
      animation: fade .4s ease;
    }
    .step.active { display:grid; }
    @keyframes fade { from {opacity:.6; transform: translateY(4px);} to {opacity:1; transform:none;} }
    .grid {
      display:grid; gap:16px;
      grid-template-columns: repeat( auto-fit, minmax(180px, 1fr) );
    }
    .pill {
      display:flex; align-items:center; justify-content:center;
      padding: 14px 16px; border-radius: 14px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.08);
      color: var(--text);
      cursor:pointer; user-select:none;
      transition: transform .06s ease, background .2s ease, border-color .2s ease;
      outline:none;
    }
    .pill:hover { background: rgba(255,255,255,.07); border-color: rgba(255,255,255,.14); }
    .pill:active { transform: scale(.98); }
    .pill.selected { background: color-mix(in oklab, var(--accent), transparent 78%); border-color: var(--accent); }
    .subtitle { color: var(--muted); font-size: .98rem; }
    .title { font-size: 1.4rem; font-weight: 700; margin: 0 0 8px; }
    .controls { display:flex; gap:12px; margin-top: 8px; flex-wrap: wrap; }
    .btn {
      background: var(--accent); color: #0b1324; font-weight: 700;
      border:none; border-radius: 12px; padding: 12px 16px; cursor:pointer;
      box-shadow: 0 6px 16px color-mix(in oklab, var(--accent), black 70%);
      transition: transform .06s ease, filter .2s ease;
    }
    .btn:hover { filter: brightness(1.05); }
    .btn:active { transform: translateY(1px) scale(.99); }
    .btn.ghost {
      background: transparent; color: var(--text); border:1px solid rgba(255,255,255,.16);
      box-shadow:none;
    }
    .panel {
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 14px; padding: 16px;
    }
    .dua {
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px; padding: 16px; line-height: 1.7;
    }
    blockquote {
      margin: 0; padding-left: 14px; border-left: 3px solid var(--accent);
      color: var(--text);
    }
    .ref { color: var(--muted); font-size: .9rem; margin-top: 8px; }
    .footer {
      padding: 14px 24px; font-size:.92rem; color: var(--muted);
      border-top: 1px solid rgba(255,255,255,.06);
      background: linear-gradient(0deg, rgba(255,255,255,.04), transparent);
      text-align:center;
    }
    .small { font-size:.95rem; color: var(--muted); }
    .q-ayah { font-style: italic; }
    .chip { display:inline-block; padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.14); background: rgba(255,255,255,.05); margin: 4px 6px 0 0; font-size:.9rem; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card" role="region" aria-label="Mood Care">
      <header>
        <div class="brand">Mood Care • Islamic Guidance</div>
        <div class="small">Authentic references included</div>
      </header>

      <!-- Step 1: Pick Mood -->
      <section id="step1" class="step active">
        <div>
          <h2 class="title">How is the mood right now?</h2>
          <p class="subtitle">Pick one to begin. The page theme adapts instantly.</p>
        </div>
        <div class="grid" role="listbox" aria-label="Mood options">
          <button class="pill" data-mood="happy" aria-label="Happy">Happy</button>
          <button class="pill" data-mood="sad" aria-label="Sad">Sad</button>
          <button class="pill" data-mood="anger" aria-label="Anger">Anger</button>
          <button class="pill" data-mood="depressed" aria-label="Depressed">Depressed</button>
          <button class="pill" data-mood="jealous" aria-label="Jealous">Jealous</button>
        </div>
        <div class="controls">
          <button class="btn" id="next1" disabled>Next</button>
        </div>
      </section>

      <!-- Step 2: Follow-up questions -->
      <section id="step2" class="step">
        <div>
          <h2 class="title" id="followupTitle">Let’s understand it better</h2>
          <p class="subtitle" id="followupSubtitle">Select what resonates most.</p>
        </div>
        <div class="grid" id="followupOptions"></div>
        <div class="controls">
          <button class="btn ghost" id="back2">Back</button>
          <button class="btn" id="next2" disabled>See Guidance</button>
        </div>
      </section>

      <!-- Step 3: Guidance -->
      <section id="step3" class="step">
        <div>
          <h2 class="title" id="resultTitle">Personalized Guidance</h2>
          <p class="subtitle">Duʿā, Qur’an, Sunnah tips, and a calming message—authentically sourced.</p>
        </div>

        <div class="panel" id="sectionCalm">
          <h3>Calming message</h3>
          <p id="calmingText"></p>
        </div>

        <div class="panel">
          <h3>Qur’an & Sunnah Guidance</h3>
          <div id="guidanceContent"></div>
        </div>

        <div class="panel">
          <h3>Duʿā to Recite</h3>
          <div class="dua" id="duaBlock"></div>
          <div class="ref" id="duaRefs"></div>
        </div>

        <div class="panel">
          <h3>Helpful Practices</h3>
          <div id="tipsList"></div>
        </div>

        <div class="controls">
          <button class="btn ghost" id="restart">Start Over</button>
        </div>
      </section>

      <div class="footer">Developed by Faisal Firoz Khan • © All rights reserved</div>
    </div>
  </div>

  <script>
    const body = document.body;
    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const step3 = document.getElementById('step3');
    const next1 = document.getElementById('next1');
    const next2 = document.getElementById('next2');
    const back2 = document.getElementById('back2');
    const restart = document.getElementById('restart');
    const followupOptions = document.getElementById('followupOptions');
    const followupTitle = document.getElementById('followupTitle');
    const followupSubtitle = document.getElementById('followupSubtitle');
    const resultTitle = document.getElementById('resultTitle');
    const calmingText = document.getElementById('calmingText');
    const guidanceContent = document.getElementById('guidanceContent');
    const duaBlock = document.getElementById('duaBlock');
    const duaRefs = document.getElementById('duaRefs');
    const tipsList = document.getElementById('tipsList');

    let selectedMood = null;
    let selectedSubtype = null;

    const moodFollowups = {
      happy: {
        title: "What’s fueling the happiness?",
        subtitle: "Gratitude anchors joy.",
        options: ["Gratitude", "Achievement", "Family time", "Answered prayer"]
      },
      sad: {
        title: "What kind of sadness is it?",
        subtitle: "Naming it helps compassionately address it.",
        options: ["Loss/Bereavement", "Loneliness", "Disappointment", "General sadness"]
      },
      anger: {
        title: "What triggered the anger?",
        subtitle: "Awareness helps channel it righteously.",
        options: ["Injustice", "Arguments", "Stress/Overload", "Traffic/Minor triggers"]
      },
      depressed: {
        title: "What feels hardest right now?",
        subtitle: "Gentle steps forward are still steps.",
        options: ["Persistent low mood", "Hopeless thoughts", "Fatigue/No motivation", "Anxiety + sadness"]
      },
      jealous: {
        title: "What kind of jealousy?",
        subtitle: "Transform comparison into growth.",
        options: ["Others’ success", "Relationships", "Wealth/Status", "Social media"]
      }
    };

    const content = {
      happy: {
        calm: "Alhamdulillah. Let joy lead to gratitude and sharing goodness.",
        quran: [
          { text: "If you are grateful, I will surely increase you. (Qur’an 14:7)", refs: [12] }
        ],
        hadith: [
          { text: "Supplication is worship, and gratitude preserves blessings.", refs: [20] }
        ],
        dua: {
          arabic: "اللَّهُمَّ مَا أَصْبَحَ بِي مِنْ نِعْمَةٍ أَوْ بِأَحَدٍ مِنْ خَلْقِكَ فَمِنْكَ وَحْدَكَ لَا شَرِيكَ لَكَ، فَلَكَ الْحَمْدُ وَلَكَ الشُّكْرُ.",
          translit: "Allahumma ma asbaha bi min ni‘matin aw bi ahadin min khalqika fa minka wahdaka la sharika lak, falaka al-ḥamdu wa laka ash-shukr.",
          translation: "O Allah, whatever blessing I or any of Your creation has risen upon is from You alone, without partner. To You is all praise and thanks.",
          refs: [20]
        },
        tips: [
          { text: "Say Alhamdulillah often; share joy with sadaqah.", refs: [20] }
        ]
      },
      sad: {
        calm: "Sadness is seen and honored in the Qur’an and Sunnah; turning to Allah brings relief and meaning.",
        quran: [
          { text: "So do not weaken and do not grieve; you will be superior if you are believers. (Qur’an 3:139)", refs: [12] }
        ],
        hadith: [
          { text: "No fatigue, disease, sorrow, sadness, hurt, or distress befalls a Muslim—even a thorn—except that Allah expiates sins thereby.", refs: [2] }
        ],
        dua: {
          arabic: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الهَمِّ وَالحَزَنِ، وَأَعُوذُ بِكَ مِنَ العَجْزِ وَالكَسَلِ، وَأَعُوذُ بِكَ مِنَ الجُبْنِ وَالبُخْلِ، وَأَعُوذُ بِكَ مِنْ غَلَبَةِ الدَّيْنِ وَقَهْرِ الرِّجَالِ.",
          translit: "Allahumma inni a‘udhu bika minal-hammi wal-ḥazan, wa a‘udhu bika minal-‘ajzi wal-kasal, wa a‘udhu bika minal-jubni wal-bukhl, wa a‘udhu bika min ghalabatid-dayni wa qahrir-rijal.",
          translation: "O Allah, I seek refuge in You from anxiety and grief, from inability and laziness, from cowardice and miserliness, and from being overcome by debt and overpowered by men.",
          refs: [8,5]
        },
        tips: [
          { text: "Recite: O Allah, there is no ease except what You make easy…", refs: [8] },
          { text: "Reflect on the Qur’an as the remover of sadness.", refs: [3,4] }
        ]
      },
      anger: {
        calm: "Pause, breathe, and seek refuge in Allah; restraint is strength.",
        quran: [
          { text: "If you are tempted by Satan, seek refuge with Allah. (Qur’an 7:200)", refs: [7] }
        ],
        hadith: [
          { text: "When one is angry, remaining silent helps.", refs: [13] },
          { text: "Say: I seek refuge with Allah from the accursed devil.", refs: [7] }
        ],
        dua: {
          arabic: "اللَّهُمَّ اغْفِرْ لِي ذَنْبِي، وَأَذْهِبْ غَيْظَ قَلْبِي، وَأَعِذْنِي مِنْ مُضِلَّاتِ الْفِتَنِ مَا أَحْيَيْتَنَا.",
          translit: "Allahummaghfir li dhanbi, wa adhhib ghaydha qalbi, wa a‘idhni min muḍillatil-fitan ma aḥyaitanā.",
          translation: "O Allah, forgive my sin, remove the anger from my heart, and protect me from misleading trials as long as You give us life.",
          refs: [7,10]
        },
        tips: [
          { text: "Change posture and perform wudu per Sunnah guidance on anger management.", refs: [7,19] }
        ]
      },
      depressed: {
        calm: "The Qur’an acknowledges deep worry and grief; turning the heart to Allah’s words brings light and relief.",
        quran: [
          { text: "Let the Qur’an be the light of the chest and the remover of grief—a prophetic supplication.", refs: [3,4] }
        ],
        hadith: [
          { text: "The Prophet taught a dua making the Qur’an the spring of the heart and the banisher of depression and anxiety.", refs: [3,4] }
        ],
        dua: {
          arabic: "اللَّهُمَّ إِنِّي عَبْدُكَ، ابْنُ عَبْدِكَ، ابْنُ أَمَتِكَ... أَنْ تَجْعَلَ الْقُرْآنَ رَبِيعَ قَلْبِي، وَنُورَ صَدْرِي، وَجَلَاءَ حُزْنِي، وَذَهَابَ هَمِّي.",
          translit: "Allahumma inni ‘abduka, ibnu ‘abdika, ibnu amatika… an taj‘ala al-Qur’āna rabi‘a qalbi, wa nūra ṣadri, wa jalā’a ḥuzni, wa dhahāba hammi.",
          translation: "O Allah, I am Your servant… I ask You to make the Qur’an the spring of my heart, the light of my chest, the remover of my sadness, and the expeller of my anxiety.",
          refs: [3,4]
        },
        tips: [
          { text: "When distressed, say: La ilaha illa Allah al-‘Azim al-Halim… Lord of the Throne.", refs: [11] },
          { text: "Persist with the anxiety/grief dua seeking refuge from future worry and past grief.", refs: [8] }
        ]
      },
      jealous: {
        calm: "Turn comparison into duʿā and effort; Allah’s favor is vast, and gratitude increases blessings.",
        quran: [
          { text: "If you are grateful, I will surely increase you. (Qur’an 14:7)", refs: [12] }
        ],
        hadith: [
          { text: "Supplicate and purify the heart from rancor and envy.", refs: [10,20] }
        ],
        dua: {
          arabic: "اللَّهُمَّ طَهِّرْ قَلْبِي مِنْ كُلِّ غِلٍّ وَحِقْدٍ وَحَسَدٍ.",
          translit: "Allahumma ṭahhir qalbi min kulli ghillin wa ḥiqdin wa ḥasad.",
          translation: "O Allah, purify my heart from every rancor, malice, and envy.",
          refs: [10]
        },
        tips: [
          { text: "Make duʿā for the person envied; give thanks for one’s own blessings.", refs: [10,12] }
        ]
      }
    };

    // Reference map for footnotes
    const refMap = {
      2: "Sahih al-Bukhari 5641-5642 (Sunnah.com).",
      3: "Sahih Ibn Hibban 972: Dua making Qur’an the spring of the heart (DailyHadithOnline).",
      4: "Hisn al-Muslim 120; graded authentic by Al-Albani (Sunnah.com).",
      5: "Jami‘ at-Tirmidhi 3484 note via Muslim & Quran: seeking refuge from grief and sorrow.",
      7: "Anger management: Qur’an 7:200; narrations on seeking refuge (Yaqeen Institute).",
      8: "Du‘as to relieve stress and anxiety; includes ‘Allahumma inni a‘udhu bika…’ (Yaqeen Institute).",
      10:"Islamic Relief Canada: du‘as including to extinguish anger and purify the heart.",
      11:"IslamQA: Distress du‘as from Sahihayn and authentic reports.",
      12:"MyIslam: Qur’anic verses compilation (e.g., 3:139; 14:7) on overcoming sadness.",
      13:"Adab al-Mufrad/Adab: ‘When angry, be silent.’ (Sunnah.com).",
      19:"DailyHadithOnline: Virtue of suppressing rage."
      // Note: All content shown is aligned to these sources only.
    };

    function setMoodTheme(mood) {
      body.classList.remove('mood-happy','mood-sad','mood-anger','mood-depressed','mood-jealous');
      if (mood) body.classList.add('mood-' + mood);
    }

    function toStep(n) {
      [step1, step2, step3].forEach(s => s.classList.remove('active'));
      document.getElementById('step'+n).classList.add('active');
    }

    // Step 1 interactions
    document.querySelectorAll('#step1 .pill').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('#step1 .pill').forEach(b=>b.classList.remove('selected'));
        btn.classList.add('selected');
        selectedMood = btn.dataset.mood;
        setMoodTheme(selectedMood);
        next1.disabled = false;
      });
    });

    next1.addEventListener('click', () => {
      // Build followups
      const cfg = moodFollowups[selectedMood];
      followupTitle.textContent = cfg.title;
      followupSubtitle.textContent = cfg.subtitle;
      followupOptions.innerHTML = '';
      cfg.options.forEach(opt => {
        const b = document.createElement('button');
        b.className = 'pill';
        b.textContent = opt;
        b.addEventListener('click', () => {
          followupOptions.querySelectorAll('.pill').forEach(x=>x.classList.remove('selected'));
          b.classList.add('selected');
          selectedSubtype = opt;
          next2.disabled = false;
        });
        followupOptions.appendChild(b);
      });
      toStep(2);
    });

    back2.addEventListener('click', () => {
      toStep(1);
    });

    next2.addEventListener('click', () => {
      renderGuidance();
      toStep(3);
    });

    restart.addEventListener('click', () => {
      selectedMood = null; selectedSubtype = null;
      document.querySelectorAll('.pill').forEach(b=>b.classList.remove('selected'));
      setMoodTheme(null);
      next1.disabled = true; next2.disabled = true;
      toStep(1);
    });

    function refBadges(refIds){
      return refIds.map(id=>`<span class="chip">[${id}] ${refMap[id]||''}</span>`).join(' ');
    }

    function renderGuidance(){
      const cfg = content[selectedMood];

      // Title tweaks per mood
      resultTitle.textContent = {
        happy: "Grounding Joy with Gratitude",
        sad: "Consolation for Sadness",
        anger: "Cooling the Flames of Anger",
        depressed: "Light for Heavy Hearts",
        jealous: "Purifying the Heart from Envy"
      }[selectedMood] || "Personalized Guidance";

      // Calming message contextualized
      calmingText.innerHTML = `${cfg.calm} <span class="chip">${selectedSubtype}</span>`;

      // Qur’an & Sunnah
      const qParts = cfg.quran.map(q=>`<p class="q-ayah">${q.text} ${refBadges(q.refs)}</p>`).join('');
      const hParts = (cfg.hadith||[]).map(h=>`<p>${h.text} ${refBadges(h.refs)}</p>`).join('');
      guidanceContent.innerHTML = qParts + hParts;

      // Dua block
      duaBlock.innerHTML = `
        <p style="font-size:1.2rem">${cfg.dua.arabic}</p>
        <p><strong>Transliteration:</strong> ${cfg.dua.translit}</p>
        <p><strong>Meaning:</strong> ${cfg.dua.translation}</p>
      `;
      duaRefs.innerHTML = refBadges(cfg.dua.refs);

      // Tips
      tipsList.innerHTML = (cfg.tips||[]).map(t=>`<p>• ${t.text} ${refBadges(t.refs)}</p>`).join('');
    }
  </script>
</body>
</html>
